2026-01-16 23:27:35 [INFO] Question: When was the highest GDP_Growth_Percent?
2026-01-16 23:27:36 [INFO] Running PandasAI with litellm LLM...
2026-01-16 23:27:36 [INFO] Prompt ID: 59b3a916-75f9-4276-adc4-41e6f915208c
2026-01-16 23:27:36 [INFO] Generating new code...
2026-01-16 23:27:36 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_iran_gdp" columns="[{"name": "Unnamed: 0", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Year", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "GDP_Current_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Per_Capita_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Inflation_Rate_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Official_Exchange_Rate", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Population_Total", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Population_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Exports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Imports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Trade_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Industry_Value_Added_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}]" dimensions="65x13">
Unnamed: 0,Year,GDP_Current_USD,GDP_Growth_Percent,GDP_Per_Capita_USD,Inflation_Rate_Percent,Official_Exchange_Rate,Population_Total,Population_Growth_Percent,Exports_USD,Imports_USD,Trade_Percent_GDP,Industry_Value_Added_Percent_GDP
0.0,1960.0,4199134389.9037,,195.57752721271,9.82241081297867,75.75000007575,21470434.0,,581541416.309979,730164938.544145,31.2375416706824,25.747575219078
1.0,1961.0,4426949094.8403,10.3909183549937,200.081529294917,3.16256439585745,75.75000007575,22125726.0,3.00641779761326,607915176.686849,702251188.378474,29.595243518665,27.8282147162268
2.0,1962.0,4693566416.48346,7.90926792965325,205.786809656996,0.721320571656337,75.75000007575,22807907.0,3.03662701704347,680443017.723241,642016253.810446,28.1759999579277,29.5449602403599
3.0,1963.0,4928628018.38759,7.04207522912871,209.559376274106,0.371849607221666,75.75000007575,23519005.0,3.07015436284033,755608234.797319,614102503.644774,27.7909132791522,30.8629517793278
4.0,1964.0,5379845647.70139,8.4752282487856,221.731727810865,3.81448957223043,75.75000007575,24262859.0,3.11379271685126,882202284.606294,878548557.845873,32.7286498118115,31.4020558314607
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 When was the highest GDP_Growth_Percent?

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-16 23:27:37 [INFO] An error occurred during code generation: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2026-01-16 23:27:38 [INFO] Stack Trace:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:38 [INFO] Execution failed with error: Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:38 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_iran_gdp" columns="[{"name": "Unnamed: 0", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Year", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "GDP_Current_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Per_Capita_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Inflation_Rate_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Official_Exchange_Rate", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Population_Total", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Population_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Exports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Imports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Trade_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Industry_Value_Added_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}]" dimensions="65x13">
Unnamed: 0,Year,GDP_Current_USD,GDP_Growth_Percent,GDP_Per_Capita_USD,Inflation_Rate_Percent,Official_Exchange_Rate,Population_Total,Population_Growth_Percent,Exports_USD,Imports_USD,Trade_Percent_GDP,Industry_Value_Added_Percent_GDP
0.0,1960.0,4199134389.9037,,195.57752721271,9.82241081297867,75.75000007575,21470434.0,,581541416.309979,730164938.544145,31.2375416706824,25.747575219078
1.0,1961.0,4426949094.8403,10.3909183549937,200.081529294917,3.16256439585745,75.75000007575,22125726.0,3.00641779761326,607915176.686849,702251188.378474,29.595243518665,27.8282147162268
2.0,1962.0,4693566416.48346,7.90926792965325,205.786809656996,0.721320571656337,75.75000007575,22807907.0,3.03662701704347,680443017.723241,642016253.810446,28.1759999579277,29.5449602403599
3.0,1963.0,4928628018.38759,7.04207522912871,209.559376274106,0.371849607221666,75.75000007575,23519005.0,3.07015436284033,755608234.797319,614102503.644774,27.7909132791522,30.8629517793278
4.0,1964.0,5379845647.70139,8.4752282487856,221.731727810865,3.81448957223043,75.75000007575,24262859.0,3.11379271685126,882202284.606294,878548557.845873,32.7286498118115,31.4020558314607
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 When was the highest GDP_Growth_Percent?

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-16 23:27:38 [INFO] An error occurred during code generation: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2026-01-16 23:27:38 [INFO] Stack Trace:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:38 [INFO] Retrying Code Generation (1/3)...
2026-01-16 23:27:38 [INFO] Execution failed with error: Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:38 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_iran_gdp" columns="[{"name": "Unnamed: 0", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Year", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "GDP_Current_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Per_Capita_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Inflation_Rate_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Official_Exchange_Rate", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Population_Total", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Population_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Exports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Imports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Trade_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Industry_Value_Added_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}]" dimensions="65x13">
Unnamed: 0,Year,GDP_Current_USD,GDP_Growth_Percent,GDP_Per_Capita_USD,Inflation_Rate_Percent,Official_Exchange_Rate,Population_Total,Population_Growth_Percent,Exports_USD,Imports_USD,Trade_Percent_GDP,Industry_Value_Added_Percent_GDP
0.0,1960.0,4199134389.9037,,195.57752721271,9.82241081297867,75.75000007575,21470434.0,,581541416.309979,730164938.544145,31.2375416706824,25.747575219078
1.0,1961.0,4426949094.8403,10.3909183549937,200.081529294917,3.16256439585745,75.75000007575,22125726.0,3.00641779761326,607915176.686849,702251188.378474,29.595243518665,27.8282147162268
2.0,1962.0,4693566416.48346,7.90926792965325,205.786809656996,0.721320571656337,75.75000007575,22807907.0,3.03662701704347,680443017.723241,642016253.810446,28.1759999579277,29.5449602403599
3.0,1963.0,4928628018.38759,7.04207522912871,209.559376274106,0.371849607221666,75.75000007575,23519005.0,3.07015436284033,755608234.797319,614102503.644774,27.7909132791522,30.8629517793278
4.0,1964.0,5379845647.70139,8.4752282487856,221.731727810865,3.81448957223043,75.75000007575,24262859.0,3.11379271685126,882202284.606294,878548557.845873,32.7286498118115,31.4020558314607
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 When was the highest GDP_Growth_Percent?

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-16 23:27:39 [INFO] An error occurred during code generation: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2026-01-16 23:27:39 [INFO] Stack Trace:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:39 [INFO] Retrying Code Generation (2/3)...
2026-01-16 23:27:39 [INFO] Execution failed with error: Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:39 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_iran_gdp" columns="[{"name": "Unnamed: 0", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Year", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "GDP_Current_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Per_Capita_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Inflation_Rate_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Official_Exchange_Rate", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Population_Total", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Population_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Exports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Imports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Trade_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Industry_Value_Added_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}]" dimensions="65x13">
Unnamed: 0,Year,GDP_Current_USD,GDP_Growth_Percent,GDP_Per_Capita_USD,Inflation_Rate_Percent,Official_Exchange_Rate,Population_Total,Population_Growth_Percent,Exports_USD,Imports_USD,Trade_Percent_GDP,Industry_Value_Added_Percent_GDP
0.0,1960.0,4199134389.9037,,195.57752721271,9.82241081297867,75.75000007575,21470434.0,,581541416.309979,730164938.544145,31.2375416706824,25.747575219078
1.0,1961.0,4426949094.8403,10.3909183549937,200.081529294917,3.16256439585745,75.75000007575,22125726.0,3.00641779761326,607915176.686849,702251188.378474,29.595243518665,27.8282147162268
2.0,1962.0,4693566416.48346,7.90926792965325,205.786809656996,0.721320571656337,75.75000007575,22807907.0,3.03662701704347,680443017.723241,642016253.810446,28.1759999579277,29.5449602403599
3.0,1963.0,4928628018.38759,7.04207522912871,209.559376274106,0.371849607221666,75.75000007575,23519005.0,3.07015436284033,755608234.797319,614102503.644774,27.7909132791522,30.8629517793278
4.0,1964.0,5379845647.70139,8.4752282487856,221.731727810865,3.81448957223043,75.75000007575,24262859.0,3.11379271685126,882202284.606294,878548557.845873,32.7286498118115,31.4020558314607
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 When was the highest GDP_Growth_Percent?

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-16 23:27:39 [INFO] An error occurred during code generation: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2026-01-16 23:27:39 [INFO] Stack Trace:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:39 [INFO] Retrying Code Generation (3/3)...
2026-01-16 23:27:39 [INFO] Execution failed with error: Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:40 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_iran_gdp" columns="[{"name": "Unnamed: 0", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Year", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "GDP_Current_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "GDP_Per_Capita_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Inflation_Rate_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Official_Exchange_Rate", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Population_Total", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Population_Growth_Percent", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Exports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Imports_USD", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Trade_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}, {"name": "Industry_Value_Added_Percent_GDP", "type": "float", "description": null, "expression": null, "alias": null}]" dimensions="65x13">
Unnamed: 0,Year,GDP_Current_USD,GDP_Growth_Percent,GDP_Per_Capita_USD,Inflation_Rate_Percent,Official_Exchange_Rate,Population_Total,Population_Growth_Percent,Exports_USD,Imports_USD,Trade_Percent_GDP,Industry_Value_Added_Percent_GDP
0.0,1960.0,4199134389.9037,,195.57752721271,9.82241081297867,75.75000007575,21470434.0,,581541416.309979,730164938.544145,31.2375416706824,25.747575219078
1.0,1961.0,4426949094.8403,10.3909183549937,200.081529294917,3.16256439585745,75.75000007575,22125726.0,3.00641779761326,607915176.686849,702251188.378474,29.595243518665,27.8282147162268
2.0,1962.0,4693566416.48346,7.90926792965325,205.786809656996,0.721320571656337,75.75000007575,22807907.0,3.03662701704347,680443017.723241,642016253.810446,28.1759999579277,29.5449602403599
3.0,1963.0,4928628018.38759,7.04207522912871,209.559376274106,0.371849607221666,75.75000007575,23519005.0,3.07015436284033,755608234.797319,614102503.644774,27.7909132791522,30.8629517793278
4.0,1964.0,5379845647.70139,8.4752282487856,221.731727810865,3.81448957223043,75.75000007575,24262859.0,3.11379271685126,882202284.606294,878548557.845873,32.7286498118115,31.4020558314607
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 When was the highest GDP_Growth_Percent?

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-16 23:27:40 [INFO] An error occurred during code generation: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.
2026-01-16 23:27:40 [INFO] Stack Trace:
Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 762, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 690, in completion
    ) = self.make_sync_openai_chat_completion_request(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\logging_utils.py", line 237, in sync_wrapper
    result = func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 502, in make_sync_openai_chat_completion_request
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 477, in make_sync_openai_chat_completion_request
    raw_response = openai_client.chat.completions.with_raw_response.create(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\resources\chat\completions\completions.py", line 1192, in create
    return self._post(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2448, in completion
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 2420, in completion
    response = openai_chat_completions.completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\llms\openai\openai.py", line 773, in completion
    raise OpenAIError(
litellm.llms.openai.common_utils.OpenAIError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1651, in wrapper
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\utils.py", line 1515, in wrapper
    result = original_function(*args, **kwargs)
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\main.py", line 4159, in completion
    raise exception_type(
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2346, in exception_type
    raise e
  File "c:\Users\USER\miniconda3\envs\pandas_ai\lib\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 492, in exception_type
    raise AuthenticationError(
litellm.exceptions.AuthenticationError: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.

2026-01-16 23:27:40 [INFO] Maximum retry attempts exceeded. Last error: litellm.AuthenticationError: AuthenticationError: OpenAIException - Incorrect API key provided: YOUR_OPE*******_KEY. You can find your API key at https://platform.openai.com/account/api-keys.
